import React from 'react'
import chroma from 'chroma-js'
import Eyes from './Eyes'
import Mouth from './Mouth'
import { formatHSL } from '../helpers/color'
import map from 'lodash/fp/map'

const Face = ({ color, shape, vOffset }) => {
  const width = 25 + shape * 50
  const x = 50 - width / 2

  return (
    <rect
      x={x}
      y={vOffset}
      rx="20"
      ry="20"
      width={width}
      height={80}
      fill={formatHSL(color)}
    />
  )
}

const Head = ({ genome, vOffset }) => {
  const { colors, eyes, mouth, shape } = genome
  const polygonCount = 4
  let colorNum = 0
  const palette = map(
    color => chroma.gl(color.red, color.blue, color.green, color.alpha).hex(),
    colors,
  )
  if (palette.length < 2) palette.push('white')
  if (palette.length < 2) palette.push('lightblue')
  const scale = chroma.scale(palette)
  //fill={scale(colorNum++/polygonCount)}

  return (
    <svg height="84" width="100" x="0" y={1 + vOffset} viewBox="0 0 100 84">
      <title>fox</title>
      <path
        d="M43.244719,77.651103 C40.70328,76.040243 38.47504,74.463563 38.293077,74.147383 C38.111112,73.831217 29.629514,68.442702 19.445079,62.172933 C6.319189,54.092339 0.9279253,50.522052 0.9279253,49.910236 C0.9279253,48.945606 4.8053738,41.765751 8.006597,36.80267 L10.098819,33.558957 L8.6674959,31.301995 C3.84125,23.691796 94.800714,22.354879 89.687541,30.638889 L87.932654,33.482021 L91.059887,38.709801 C92.779877,41.58509 94.927644,45.295902 95.832711,46.956067 C97.291217,49.63138 97.395355,50.055076 96.748712,50.682789 C96.347434,51.07232 88.179027,56.216295 78.596703,62.113825 C69.01438,68.011368 60.452554,73.470323 59.57043,74.244848 C57.236508,76.294061 49.828094,80.667579 48.770766,80.62037 C48.272882,80.59817 45.786158,79.261977 43.244719,77.651103 Z"
        id="silhouette"
        fill={scale(colorNum++ / polygonCount)}
        fill-rule="nonzero"
      />
      <path
        d="M44.301661,79.18301 C42.07402,77.821928 40.139089,76.415637 40.001817,76.057914 C39.864547,75.700178 40.100277,73.877236 40.525675,72.006919 C41.602765,67.271321 41.524543,60.350592 40.341651,55.725531 C38.524103,48.618985 34.247019,41.931668 28.229179,36.787401 C25.088336,34.102496 17.237447,30.007993 15.230193,30.007993 C14.296894,30.007993 13.378068,30.549733 12.281006,31.746835 L10.687477,33.485677 L9.759946,32.172436 C5.657642,26.364196 0.4260484,10.674916 0.4489732,4.2493022 C0.4605549,0.9949922 0.8540452,0.6903306 4.9255682,0.7830336 C11.410726,0.9306918 24.405831,5.1103766 31.291254,9.263169 L34.585263,11.249879 L37.343771,10.011934 C45.361172,6.4139374 52.311928,6.3928919 60.190919,9.942764 C63.169727,11.284859 63.318772,11.303902 64.568518,10.502054 C70.289937,6.8311442 81.211433,2.5965443 88.546263,1.205153 C96.249734,-0.25617094 97.489415,0.2439798 97.364167,4.762739 C97.265307,8.3306671 95.896438,14.256571 93.807861,20.158402 C92.279741,24.476513 89.226976,30.944796 87.856863,32.767526 C87.175626,33.673797 87.126487,33.661612 86.285353,32.377865 C85.807788,31.649012 84.840842,30.75471 84.136593,30.390526 C83.021801,29.814049 82.517405,29.847658 80.238324,30.650267 C76.692413,31.898999 71.675216,34.940107 68.60108,37.704027 C60.525229,44.964899 55.82756,56.028064 56.540923,66.106083 C56.702544,68.389412 57.161973,71.452683 57.561876,72.913354 C58.224902,75.33511 58.217889,75.647664 57.482296,76.460491 C56.464806,77.584796 49.733965,81.693135 48.942666,81.672854 C48.617755,81.664554 46.529302,80.544095 44.301661,79.183013 L44.301661,79.18301 Z"
        id="nose-bridge"
        fill={scale(colorNum++ / polygonCount)}
        fill-rule="nonzero"
      />
      <path
        d="M11.153761,27.233853 C9.326314,23.6137 7.2779011,16.637489 7.1449131,13.581056 C6.9949979,10.135563 7.7223122,9.515066 11.461784,9.898187 C15.960907,10.359135 27.19352,14.290665 27.19352,15.404455 C27.19352,15.628191 25.860003,17.117675 24.230146,18.71442 C22.600291,20.311167 19.630554,23.532795 17.630732,25.873594 C15.630908,28.214394 13.684378,30.129593 13.305108,30.129593 C12.925838,30.129593 11.957733,28.82651 11.153761,27.233853 Z M82.985802,29.005589 C82.396046,28.387387 80.19128,25.861645 78.086337,23.392826 C75.981381,20.924009 73.518978,18.339512 72.614338,17.6495 C71.709685,16.95949 70.969519,16.096281 70.969519,15.73126 C70.969519,14.272131 81.160336,10.42894 86.512933,9.869483 C89.846444,9.521062 90.911917,10.284669 90.911917,13.022157 C90.911917,17.220782 86.25309,30.129593 84.737793,30.129593 C84.363966,30.129593 83.575571,29.623792 82.985802,29.005589 Z"
        id="ears"
        fill={scale(colorNum++ / polygonCount)}
        fill-rule="nonzero"
      />
      <path
        d="M39.975786,76.026644 C39.743318,75.315046 44.938776,74.391986 49.17657,74.391986 C52.185707,74.391986 57.253776,75.106121 57.74733,75.599666 C57.87273,75.725134 57.69867,76.161047 57.360522,76.568487 C56.560695,77.532221 49.710462,81.690775 48.942666,81.678697 C48.617754,81.673197 46.508019,80.524458 44.254365,79.125088 C42.00071,77.725718 40.075351,76.331421 39.975786,76.026644 Z"
        id="nose"
        fill={scale(colorNum++ / polygonCount)}
      />
    </svg>
  )
}

export default Head
